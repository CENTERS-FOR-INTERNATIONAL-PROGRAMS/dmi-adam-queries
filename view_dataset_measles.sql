CREATE VIEW view_dataset_measles
AS
SELECT
    (couchdb.doc ->> 'ident')::BIGINT AS case_unique_id,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'given'::text) ->> 'df_value'::text AS case_given_name,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'family'::text) ->> 'df_value'::text AS case_family_name,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'gender'::text) ->> 'df_value'::text AS case_gender,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'date_of_birth'::text) ->> 'df_value'::text::DATE AS case_date_of_birth,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'age_years'::text) ->> 'df_value'::text::INTEGER AS case_age_years,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'age_months'::text) ->> 'df_value'::text::INTEGER AS case_age_months,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'phone_number'::text) ->> 'df_value'::text AS case_phone_number,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'occupation'::text) ->> 'df_value'::text AS case_occupation,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'occupation_other'::text) ->> 'df_value'::text AS case_occupation_other,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'country'::text) ->> 'df_value'::text AS case_residential_country,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'county'::text) ->> 'df_value'::text AS case_residential_county,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'subcounty'::text) ->> 'df_value'::text AS case_residential_subcounty,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'town_village_camp'::text) ->> 'df_value'::text AS case_residential_town_village_camp,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'landmark'::text) ->> 'df_value'::text AS case_landmark,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'title_residence'::text) ->> 'df_value'::text AS case_title_residence,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'title_parent_guardian'::text) ->> 'df_value'::text AS case_title_parent_guardian,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'guardian_family_name'::text) ->> 'df_value'::text AS case_guardian_family_name,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'guardian_given_name'::text) ->> 'df_value'::text AS case_guardian_given_name,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'guardian_phone_number'::text) ->> 'df_value'::text AS case_guardian_phone_number,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'title_respondent'::text) ->> 'df_value'::text AS case_title_respondent,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'respondent'::text) ->> 'df_value'::text AS case_respondent,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'respondent_family_name'::text) ->> 'df_value'::text AS case_respondent_family_name,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'respondent_given_name'::text) ->> 'df_value'::text AS case_respondent_given_name,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'respondent_address'::text) ->> 'df_value'::text AS case_respondent_address,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'respondent_phone_number'::text) ->> 'df_value'::text AS case_respondent_phone_number,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'respondent_relationship'::text) ->> 'df_value'::text AS case_respondent_relationship,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'respondent'::text) ->> 'df_value'::text AS case_res_respondent,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'family'::text) ->> 'df_value'::text AS case_res_family,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'given_name'::text) ->> 'df_value'::text AS case_res_given_name,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'phone_number'::text) ->> 'df_value'::text AS case_res_phone_number,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'address'::text) ->> 'df_value'::text AS case_res_address,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'relationship'::text) ->> 'df_value'::text AS case_res_relationship,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'relationship_other'::text) ->> 'df_value'::text AS case_res_relationship_other,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_vaccination'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'vaccinated'::text) ->> 'df_value'::text AS case_vac_vaccinated,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_vaccination'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'vaccine_name'::text) ->> 'df_value'::text AS case_vac_vaccine_name,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_vaccination'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'vaccine_doses'::text) ->> 'df_value'::text::INTEGER AS case_vac_vaccine_doses,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_vaccination'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'health_facility'::text) ->> 'df_value'::text AS case_vac_health_facility,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_vaccination'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'vaccination_date'::text) ->> 'df_value'::text::DATE AS case_vac_vaccination_date,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'laboratory_sample_collected'::text) ->> 'df_value'::text AS case_lab_laboratory_sample_collected,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'laboratory_samples_collected'::text) ->> 'df_value'::text AS case_lab_laboratory_samples_collected,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'laboratory_samples_collected_others'::text) ->> 'df_value'::text AS case_lab_laboratory_samples_collected_others,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'sample_date'::text) ->> 'df_value'::text::DATE AS case_lab_sample_date,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'rdt_done'::text) ->> 'df_value'::text AS case_lab_rdt_done,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'rdt_results'::text) ->> 'df_value'::text AS case_lab_rdt_results,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'samples_sent_to_laboratory'::text) ->> 'df_value'::text AS case_lab_samples_sent_to_laboratory,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'laboratory_name'::text) ->> 'df_value'::text AS case_lab_laboratory_name,
    ((((((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'sample_sent_to_lab_date'::text) ->> 'df_value'::text::DATE AS case_lab_sample_sent_to_lab_date,
    ((((((couchdb.doc -> 'DForms'::text) -> 'clinical_information_measles'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'symptoms'::text) ->> 'df_value'::text AS symptoms,
    ((((((couchdb.doc -> 'DForms'::text) -> 'clinical_information_measles'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'symptoms_other'::text) ->> 'df_value'::text AS symptoms_other,
    ((((((couchdb.doc -> 'DForms'::text) -> 'clinical_information_measles'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'rash_type'::text) ->> 'df_value'::text AS rash_type,
    ((((((couchdb.doc -> 'DForms'::text) -> 'clinical_information_measles'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'date_of_onset_rash'::text) ->> 'df_value'::text::DATE AS date_of_onset_rash,
    ((((((couchdb.doc -> 'DForms'::text) -> 'clinical_information_measles'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'residence_visited'::text) ->> 'df_value'::text AS residence_visited,
    ((((((couchdb.doc -> 'DForms'::text) -> 'clinical_information_measles'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'residence_visited_date'::text) ->> 'df_value'::text::DATE AS residence_visited_date,
    ((((((couchdb.doc -> 'DForms'::text) -> 'clinical_information_measles'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'case_epilinked'::text) ->> 'df_value'::text AS case_epilinked,
    ((((((couchdb.doc -> 'DForms'::text) -> 'clinical_information_measles'::text) -> 0) -> 'DFields'::text) -> 'values'::text) -> 'outcome'::text) ->> 'df_value'::text AS outcome,
    (((couchdb.doc -> 'DFields'::text) -> 'values'::text) -> 'disease'::text) ->> 'df_value'::text AS disease,
    (((couchdb.doc -> 'DFields'::text) -> 'values'::text) -> 'EPID'::text) ->> 'df_value'::text AS epid,
    (((couchdb.doc -> 'DFields'::text) -> 'values'::text) -> 'date_of_investigation'::text) ->> 'df_value'::text::DATE AS investigation_date,
    couchdb.doc ->> 'fform_id'::text AS fform_id,
    ((couchdb.doc -> 'location'::text) ->> 'accuracy')::FLOAT AS location_accuracy,
    ((couchdb.doc -> 'location'::text) ->> 'latitude')::FLOAT AS location_latitude,
    ((couchdb.doc -> 'location'::text) ->> 'longitude')::FLOAT AS location_longitude,
    couchdb.doc ->> 'mform_id'::text AS mform_id,
    couchdb.doc ->> 'created_username'::text AS created_username,
    couchdb.doc ->> 'created_timestamp'::text::TIMESTAMP AS created_timestamp,
    couchdb.doc ->> 'modified_username'::text AS modified_username,
    couchdb.doc ->> 'modified_timestamp'::text::TIMESTAMP AS modified_timestamp,
    couchdb.doc
FROM couchdb
WHERE (couchdb.doc ->> 'type'::text) = 'dform'::text
  AND (((couchdb.doc -> 'DFields'::text) -> 'values'::text) -> 'disease'::text) ->> 'df_value'::text = 'Measles'::text
  AND (couchdb.doc -> 'ident'::text) IS NOT NULL;

ALTER TABLE view_dataset_measles
    OWNER TO postgres_root;