CREATE VIEW view_dataset_respiratory_syndrome AS

SELECT
    (couchdb.doc ->> 'ident')::BIGINT AS case_unique_id,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'given'::text ->> 'df_value'::text AS given_name,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'family'::text ->> 'df_value'::text AS family_name,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'gender'::text ->> 'df_value'::text AS gender,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'date_of_birth'::text ->> 'df_value'::DATE AS date_of_birth,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'age_months'::text ->> 'df_value'::INT AS age_months,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'age_years'::text ->> 'df_value'::INT AS age_years,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'phone_number'::text ->> 'df_value'::text AS phone_number,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'occupation'::text ->> 'df_value'::text AS occupation,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'occupation_other'::text ->> 'df_value'::text AS occupation_other,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'title_residence'::text ->> 'df_value'::text AS title_residence,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'country'::text ->> 'df_value'::text AS country,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'county'::text ->> 'df_value'::text AS county,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'subcounty'::text ->> 'df_value'::text AS subcounty,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'town_village_camp'::text ->> 'df_value'::text AS town_village_camp,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'landmark'::text ->> 'df_value'::text AS landmark,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'title_parent_guradian'::text ->> 'df_value'::text AS title_parent_guardian,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'guardian_family_name'::text ->> 'df_value'::text AS guardian_family_name,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'guardian_given_name'::text ->> 'df_value'::text AS guardian_given_name,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'guardian_phone_number'::text ->> 'df_value'::text AS guardian_phone_number,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'title_respondent'::text ->> 'df_value'::text AS title_respondent,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'respondent'::text ->> 'df_value'::text AS respondent,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'respondent_family_name'::text ->> 'df_value'::text AS respondent_family_name,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'respondent_given_name'::text ->> 'df_value'::text AS respondent_given_name,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'respondent_address'::text ->> 'df_value'::text AS respondent_address,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'respondent_phone_number'::text ->> 'df_value'::text AS respondent_phone_number,
    (((couchdb.doc -> 'DForms'::text) -> 'case_demographics'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'respondent_relationship'::text ->> 'df_value'::text AS respondent_relationship,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'food_name'::text ->> 'df_value'::text AS food_name,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'food_source'::text ->> 'df_value'::text AS food_source,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'toilet_types'::text ->> 'df_value'::jsonb AS toilet_types,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'exposure_type'::text ->> 'df_value'::text AS exposure_type,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'water_sources'::text ->> 'df_value'::jsonb AS water_sources,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'animal_species'::text ->> 'df_value'::text AS animal_species,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'animal_exposure'::text ->> 'df_value'::text AS animal_exposure,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'record_exposure'::text ->> 'df_value'::text AS record_exposure,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'toilet_types_other'::text ->> 'df_value'::text AS toilet_types_other,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'travel_origin_city'::text ->> 'df_value'::text AS travel_origin_city,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'travel_arrival_date'::text ->> 'df_value'::DATE AS travel_arrival_date,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'water_sources_other'::text ->> 'df_value'::text AS water_sources_other,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'animal_species_other'::text ->> 'df_value'::text AS animal_species_other,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'animal_exposure_other'::text ->> 'df_value'::text AS animal_exposure_other,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'food_consumption_date'::text ->> 'df_value'::DATE AS food_consumption_date,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'travel_departure_date'::text ->> 'df_value'::DATE AS travel_departure_date,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'travel_origin_country'::text ->> 'df_value'::text AS travel_origin_country,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'food_participants_count'::text ->> 'df_value'::INT AS food_participants_count,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'travel_destination_city'::text ->> 'df_value'::text AS travel_destination_city,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'animal_exposure_location'::text ->> 'df_value'::text AS animal_exposure_location,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'travel_destination_country'::text ->> 'df_value'::text AS travel_destination_country,
    ((couchdb.doc -> 'DForms'::text) -> 'case_exposure'::text) -> 0 -> 'DFields'::text -> 'values'::text -> 'food_affected_participants_count'::text ->> 'df_value'::INT AS food_affected_participants_count,
    ((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'respondent'::text ->> 'df_value'::text AS respondent,
    ((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'family'::text ->> 'df_value'::text AS respondent_family_name,
    ((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'given_name'::text ->> 'df_value'::text AS respondent_given_name,
    ((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'phone_number'::text ->> 'df_value'::text AS respondent_phone_number,
    ((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'address'::text ->> 'df_value'::text AS respondent_address,
    ((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'relationship'::text ->> 'df_value'::text AS respondent_relationship,
    ((couchdb.doc -> 'DForms'::text) -> 'case_repondent'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'relationship_other'::text ->> 'df_value'::text AS respondent_relationship_other,
    ((couchdb.doc -> 'DForms'::text) -> 'case_vaccination'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'vaccinated'::text ->> 'df_value'::text AS vaccinated,
    ((couchdb.doc -> 'DForms'::text) -> 'case_vaccination'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'vaccine_name'::text ->> 'df_value'::text AS vaccine_name,
    ((couchdb.doc -> 'DForms'::text) -> 'case_vaccination'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'vaccine_doses'::text ->> 'df_value'::text AS vaccine_doses,
    ((couchdb.doc -> 'DForms'::text) -> 'case_vaccination'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'health_facility'::text ->> 'df_value'::text AS health_facility,
    ((couchdb.doc -> 'DForms'::text) -> 'case_vaccination'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'vaccination_date'::text ->> 'df_value'::DATE AS vaccination_date,
    ((couchdb.doc -> 'DForms'::text) -> 'reporting_location'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'county'::text ->> 'df_value'::text AS reporting_county,
    ((couchdb.doc -> 'DForms'::text) -> 'reporting_location'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'subcounty'::text ->> 'df_value'::text AS reporting_subcounty,
    ((couchdb.doc -> 'DForms'::text) -> 'reporting_location'::text -> 0 -> 'DFields'::text -> 'values'::text) -> 'health_facility'::text ->> 'df_value'::text AS reporting_health_facility,
    (((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'laboratory_sample_collected'::text ->> 'df_value'::text AS laboratory_sample_collected,
    (((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'laboratory_samples_collected'::text ->> 'df_value'::text AS laboratory_samples_collected,
    (((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'laboratory_samples_collected_others'::text ->> 'df_value'::text AS laboratory_samples_collected_others,
    (((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'sample_date'::text ->> 'df_value'::DATE AS sample_date,
    (((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'rdt_done'::text ->> 'df_value'::text AS rdt_done,
    (((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'rdt_results'::text ->> 'df_value'::text AS rdt_results,
    (((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'samples_sent_to_laboratory'::text ->> 'df_value'::text AS samples_sent_to_laboratory,
    (((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'laboratory_name'::text ->> 'df_value'::text AS laboratory_name,
    (((couchdb.doc -> 'DForms'::text) -> 'case_lab_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'sample_sent_to_lab_date'::text ->> 'df_value'::DATE AS sample_sent_to_lab_date,
    (((couchdb.doc -> 'DForms'::text) -> 'case_clinical_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'symptoms'::text ->> 'df_value'::text AS symptoms,
    (((couchdb.doc -> 'DForms'::text) -> 'case_clinical_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'symptoms_other'::text ->> 'df_value'::text AS symptoms_other,
    (((couchdb.doc -> 'DForms'::text) -> 'case_clinical_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'date_of_onset'::text ->> 'df_value'::DATE AS date_of_onset,
    (((couchdb.doc -> 'DForms'::text) -> 'case_clinical_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'underlying_conditions_comorbidities'::text ->> 'df_value'::text AS underlying_conditions_comorbidities,
    (((couchdb.doc -> 'DForms'::text) -> 'case_clinical_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'underlying_conditions_comorbidities_others'::text ->> 'df_value'::text AS underlying_conditions_comorbidities_others,
    (((couchdb.doc -> 'DForms'::text) -> 'case_clinical_information'::text) -> 0 -> 'DFields'::text -> 'values'::text) -> 'outcome'::text ->> 'df_value'::text AS outcome,
    ((couchdb.doc -> 'DFields'::text) -> 'values'::text) -> 'EPID'::text ->> 'df_value'::text AS epid,
    ((couchdb.doc -> 'DFields'::text) -> 'values'::text) -> 'date_of_investigation'::text ->> 'df_value'::DATE AS date_of_investigation,
    ((couchdb.doc -> 'DFields'::text) -> 'values'::text) -> 'disease'::text ->> 'df_value'::text AS disease,
    ((couchdb.doc -> 'DFields'::text) -> 'values'::text) -> 'syndrome'::text ->> 'df_value'::text AS syndrome,
    (couchdb.doc ->> 'fform_id') AS form_id,
    (couchdb.doc -> 'location' ->> 'accuracy')::INTEGER AS location_accuracy,
    (couchdb.doc -> 'location' ->> 'latitude')::DOUBLE PRECISION AS location_latitude,
    (couchdb.doc -> 'location' ->> 'longitude')::DOUBLE PRECISION AS location_longitude,
    couchdb.doc ->> 'mform_id' AS mform_id,
    couchdb.doc ->> 'created_username' AS created_username,
    couchdb.doc ->> 'created_timestamp' AS created_timestamp,
    couchdb.doc ->> 'modified_username' AS modified_username,
    couchdb.doc ->> 'modified_timestamp' AS modified_timestamp
    couchdb.doc
FROM couchdb
WHERE (couchdb.doc ->> 'type'::text) = 'dform'::text
  AND (((couchdb.doc -> 'DFields'::text) -> 'values'::text) -> 'disease'::text) ->> 'df_value'::text = 'Respiratory Syndrome'::text
  AND (couchdb.doc -> 'ident'::text) IS NOT NULL;

ALTER TABLE view_dataset_respiratory_syndrome 
OWNER TO postgres_root;